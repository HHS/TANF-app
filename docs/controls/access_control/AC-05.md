# Access Control
## AC-05 - Separation of Duties

The organization:  
a. Separates [at a minimum, data creation and control, software development and maintenance, and security functions];

b. Documents separation of duties of individuals; and 

c. Defines information system access authorizations to support separation of duties.

### TDP Implementation

**Part a.**  
Software development and maintenance is separated through the following:
* Developers will deploy new code through GitHub, initiating the continuous integration process through Circle CI.
* System owner manages the account access. Additionally, System owner provisions a new user account on request.

Data creation and control action can be completed through the TDP application by a user who has been authenticated and is active in the system. These roles include OFA admin and STT users. 
* OFA admins will upload data on behalf of STTs and upload data files locally into the web application which will store the files in cloud.gov AWS S3 buckets. 
* These users cannot provision new accounts and do not have access to the account management functionality.

**Part b.**    
**Privileged users:** Users with responsibilities for software development, maintenance, and security functions will have access to all areas of the system. This includes dev and system owner. These users have the *superuser* flag set to true in the DAC. These users can add a new user, edit a user, and perform any account management related controls. All of the actions are logged into the system logs.

**Non-privileged users - OFA Admin:** These are active users that can login but do not have special privileges. This type of user includes OFA admin. These users have the *staff* flag set to true in DAC. These users can upload TANF reports, and replace and download uploaded TANF reports through the TDP interface.

**Part c.**   
Access to the TDRS system occurs in two different ways: through the Django admin interface and through the TDRS application interface.  

***Access to the Django admin interface***  

Access directly to the Django interface occurs through a combination of flags and assigned permissions based on responsibilities.  

- **active flag:** This flag, on creation of a new user, is set to true. Users that are not flagged as active are not able to login into the system and considered inactive. This flag could be changed in any of the following circumstances (and, others):

  - deactivation of a user
  - reactivation of a user  
  
- **superuser flag:** On creation of a new user, this flag is set to false. Creation of a superuser must be done explicitly. If a user is flagged and logged in as a superuser, the user has permissions to create, read, update and delete data in the Django admin, which includes model records and other users.  

- **staff flag:** This flag, on creation of a new user, is set to false. If a user is flagged and logged in as staff, the user can log into the Django admin. If a staff flag is attached to a user, this differentiates the user as an administrator of the system versus a public user. Active, non-superuser staff members are granted administrative access through assigned permissions.  

***Access to the TDRS system: Overview***  

- **Login:** Login to the system GET request is sent to ***v1/login/oidc endpoint***. Not authorization protected. Users authenticate with Login.gov via the system’s backend service. Upon successful authentication, the backend service will create httpOnly cookie and stored by the clients browser for authenticating future requests to the API. The secured portion of this authorization is due to the httpOnly cookie being inaccessible to the client’s local browser. The user is then redirected to the frontend landing page.

- **On-going Authorization:** Authorization checks are carried out with GET requests to ***v1/auth_check*** endpoint where the JSON response that includes profile information including “authenticated”: True. This also refreshes the user session. Authorization is protected.

- **Logout:** Logout of the system is through a GET request to ***v1/logout/oidc***. Not Authorization protected. This will destroy the current user session while also logging out of Login.gov, after which, the user is redirected to the landing page.

- **Updating Profile:** In order for users to update their profile, a PATCH request is sent to ***v1/set_profile*** endpoint. This action can be performed through the TDP interface by the user or an administrator.  

- The following endpoints, which are protected, are accessed to view data if the user is authenticated:  

  - GET ***/v1/stts/*** Returns a JSON response with a list of all States, Tribes and Territories in the system
  - GET ***/v1/stts/alpha*** Returns a JSON response as above but sorted by the “name” (of the entity).
  - GET ***/v1/stts/by_region*** Returns a JSON response sodrted by “stts” (the top level region)

***Access to the TDRS system: Roles***  

- ***OFA Admin:***  
  - approves new users, updates profile information, inactivates, and reactivates users
  - reads data over assigned region
  - able to upload and submit new TANF reports, replace and resubmit TANF reports  

- ***Data Preppers:***
  - able to upload and submit new TANF reports, replace and resubmit TANF reports
  - access (to be defined) allows the development of reports as required

#### Related Files
