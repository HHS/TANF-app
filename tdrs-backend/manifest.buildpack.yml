version: 1
applications:
- name: tdp-backend
  memory: 1G
  instances: 1
  disk_quota: 7G
  command: |
    python manage.py runscript create_grafana_postgres_role --script-args read_only stt_section_to_type_mapping data_files_datafile django_admin_log parsers_datafilesummary parser_error stts_stt stts_region users_user users_user_groups ssp_m1 ssp_m2 ssp_m3 ssp_m4 ssp_m5 ssp_m6 ssp_m7 tanf_t1 tanf_t2 tanf_t3 tanf_t4 tanf_t5 tanf_t6 tanf_t7 tribal_tanf_t1 tribal_tanf_t2 tribal_tanf_t3 tribal_tanf_t4 tribal_tanf_t5 tribal_tanf_t6 tribal_tanf_t7
    python manage.py runscript create_grafana_postgres_role --script-args admin_read_only all
    python manage.py runscript create_grafana_readonly_postgres_users --script-args ofa_read_only $OFA_READ_ONLY_PASSWORD read_only ofa_admin_read_only $OFA_ADMIN_READ_ONLY_PASSWORD admin_read_only
    ./gunicorn_start.sh cloud
  buildpacks:
  - https://github.com/cloudfoundry/apt-buildpack
  - https://github.com/cloudfoundry/python-buildpack.git#v1.8.3
  - https://github.com/cloudfoundry/binary-buildpack
  services:
  - tdp-db-{cg_space}
  - tdp-staticfiles-{cg_space}
  - tdp-datafiles-{cg_space}
  - tdp-redis-{cg_space}
